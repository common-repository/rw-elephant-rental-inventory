!function(a){var b={init:function(){a(".rwe-color-picker").each(function(){a(this).wpColorPicker()})}},c={init:function(){a(".js-sortable").sortable({items:".item",axis:"y",placeholder:{element:function(b){var c=b.is("tr"),d=a(b).height()+"px",e=a(b).width()+"px";return a(c?'<tr class="placeholder" style="height: '+d+"; width: "+e+';"><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>':'<li class="placeholder" style="height: '+d+"; width: "+e+';">&nbsp;</li>')[0]},update:function(){}},helper:function(b,c){if(!c.is("tr"))return c;var d=c.children(),e=c.clone();return e.children().each(function(b){a(this).width(d.eq(b).outerWidth())}),e}}).disableSelection()}},d={addImage:function(){var b=a(this);media_uploader=wp.media({frame:"post",state:"insert",multiple:!1}),media_uploader.on("insert",function(){var a=media_uploader.state().get("selection").first().toJSON(),c=a.url,d=a.id,e=b.closest("td"),f=e.find(".image-wrap");b.addClass("hidden"),e.find(".js-image-url").val(c),e.find(".js-image-id").val(d),f.find("img.image-preview").attr("src",c),f.removeClass("hidden")}),media_uploader.open()},removeImage:function(b){b.preventDefault();var c=a(this),d=c.closest("td");d.find(".image-wrap").addClass("hidden"),d.find(".js-image-url").val(""),d.find(".js-image-id").val(""),d.find(".image-preview").attr("src",""),d.find(".js-add-image").removeClass("hidden")}};rwItemNotes={add:function(b){b.preventDefault();var c=a(".item-note.cloneable"),d=c.clone();d.removeClass("cloneable hidden"),d.appendTo(".item-notes"),a(".item-notes").children("li").each(function(){var b=a(this).index();d.find('input[type="text"]').attr("name","rw-elephant-rental-inventory[item-notes]["+b+"][title]"),d.find("textarea").attr("name","rw-elephant-rental-inventory[item-notes]["+b+"][text]")})},remove:function(b){b.preventDefault(),a(this).closest("li.item-note").fadeOut("fast",function(){a.when(a(this).remove()).then(function(){a(".item-notes").children("li").each(function(){var b=a(this).index();a(this).find('input[type="text"]').attr("name","rw-elephant-rental-inventory[item-notes]["+b+"][title]"),a(this).find("textarea").attr("name","rw-elephant-rental-inventory[item-notes]["+b+"][text]")})})})}},rwFormFields={add:function(b){b.preventDefault();var c=a(this);a.featherlight(a("#edit-field"),{variant:"rw-elephant-edit-wishlist-field",afterOpen:function(){var b={action:"get_wishlist_form_field_data",key:a(".wishlist-form-field").length,type:c.data("type")};a.post(ajaxurl,b,function(b){if(a("#edit-field > .preloader").hide(),!b.success)return void a("#edit-field > div.js-edit-field-form").html('<div class="rwe-alert danger">'+rwElephant.editFieldError+"</div>").removeClass("hidden");a("#edit-field > div.js-edit-field-form").html(b.data).removeClass("hidden").find('input[type="submit"]').addClass("add-field").val(rwElephant.addFieldBtnText)})},afterClose:function(){a("#edit-field > .preloader").removeClass("updating").show(),a("#edit-field > .js-update-wishlist-field").find("input").attr("disabled","disabled"),a("#edit-field > div.js-edit-field-form").html("").addClass("hidden")}})},remove:function(b){if(b.preventDefault(),confirm(rwElephant.removeFieldConfirmation)){var c=a(this),d={action:"delete_wishlist_form_field",key:c.data("key")};a.post(ajaxurl,d,function(b){if(!b.success)return void a(".wishlist-form-fields").before('<div class="rwe-alert danger add-field-error"><p>'+b.data.message+"</p></div>");c.parent("li").remove()})}},edit:function(b){var c=a(this);a.featherlight(a("#edit-field"),{variant:"rw-elephant-edit-wishlist-field",afterOpen:function(){var b={action:"get_wishlist_form_field_data",key:c.data("key"),type:c.closest("li").find(".field-type").val()};a.post(ajaxurl,b,function(b){if(a("#edit-field > .preloader").hide(),!b.success)return void a("#edit-field > div.js-edit-field-form").html('<div class="rwe-alert danger">'+rwElephant.editFieldError+"</div>").removeClass("hidden");a("#edit-field > div.js-edit-field-form").html(b.data).removeClass("hidden")})},afterClose:function(){a("#edit-field > .preloader").removeClass("updating").show(),a("#edit-field > .js-update-wishlist-field").find("input").attr("disabled","disabled"),a("#edit-field > div.js-edit-field-form").html("").addClass("hidden")}})},addOption:function(b){b.preventDefault();var c=a(".rw-elephant-edit-wishlist-field").find(".js-update-wishlist-field, .js-add-wishlist-field"),d=c.find("li.blank-options").clone(),e=c.find("li.no-options-message"),f=c.find("ul.options");e.hide(),f.append(d),f.find("li.blank-options").removeAttr("class")},addField:function(b){b.preventDefault();var c=a(".rw-elephant-edit-wishlist-field"),d=a(this).serialize();c.find("h2").fadeTo("fast",.5),c.find(".js-edit-field-form").fadeTo("fast",.5,function(){c.find("input").attr("disabled","disabled"),c.find(".preloader").addClass("updating").show();var b={action:"add_wishlist_form_field",data:d};a.post(ajaxurl,b,function(b){if(a.featherlight.close(),!b.success)return void a(".wishlist-form-fields").before('<div class="rwe-alert danger add-field-error"><p>'+b.data.message+"</p></div>");a(".wishlist-form-fields > ul").append(b.data)})})},updateField:function(b){b.preventDefault();var c=a(".rw-elephant-edit-wishlist-field"),d=c.find(".js-field-key").val(),e=a(this).serialize();c.find("h2").fadeTo("fast",.5),c.find(".js-edit-field-form").fadeTo("fast",.5,function(){c.find("input").attr("disabled","disabled"),c.find(".preloader").addClass("updating").show();var b={action:"update_wishlist_form_field",key:d,data:e};a.post(ajaxurl,b,function(b){if(a.featherlight.close(),!b.success)return void a(".wishlist-form-fields").before('<div class="rwe-alert danger add-field-error"><p>'+b.data.message+"</p></div>");var c=a('span[data-key="'+d+'"]').closest("li");return c.length?void c.replaceWith(b.data):void 0})})}};var e={init:function(){var b=this.checked?rwElephant.siwtchLabels.toggleCache.enabled:rwElephant.siwtchLabels.toggleCache.disabled;a(this).closest(".display").find("label.toggle-label").text(b),e.toggleCache(this.checked)},toggleCache:function(b){var c={action:"toggle_cache",cacheEnabled:b};a.post(ajaxurl,c,function(c){if(b)return void a("#flush-cache").removeAttr("disabled");a("#flush-cache").attr("disabled","disabled")})}};a(document).ready(b.init),a(document).ready(c.init),a(document).on("click",".js-add-image",d.addImage),a(document).on("click",".js-remove-image",d.removeImage),a(document).on("click",".js-add-item-note",rwItemNotes.add),a(document).on("click",".js-remove-item-note",rwItemNotes.remove),a(document).on("click",".js-add-field",rwFormFields.add),a(document).on("click",".js-remove-field",rwFormFields.remove),a(document).on("click",".js-edit-field",rwFormFields.edit),a(document).on("click",".js-add-option",rwFormFields.addOption),a(document).on("submit",".js-update-wishlist-field",rwFormFields.updateField),a(document).on("submit",".js-add-wishlist-field",rwFormFields.addField),a(document).on("change",".rwe-toggle-cache",e.init)}(jQuery);